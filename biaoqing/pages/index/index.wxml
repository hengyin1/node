<!--index.wxml-->
<view class="container">
  <view class="pic-box flex-row-center" bind:touchstart="touchstart" bind:touchmove="touchmove">
    <view style="position: relative;">
      <image wx:if="{{temInfo.path}}" src="{{temInfo.path}}" style="display: block;width: {{temInfo.width}}px;height: {{temInfo.height}}px;" />
      <view wx:if="{{faceInfo.path}}" class="face-box" style="left: {{temInfo.face_center_x}}px;top: {{temInfo.face_center_y}}px;width: {{faceInfo.width}}px;height: {{faceInfo.height}}px;">
        <image src="{{faceInfo.path}}" style="display: block;width: 100%;height: 100%;" />
        <!-- <image class="scale-icon" src="/images/scale.png" /> -->
      </view>
    </view>
  </view>

  <view>
    <view class="up-tab flex-row">
      <view class="up-tab-item" wx:for="{{upTabs}}" wx:key="index" data-index="{{item.value}}" bind:tap="tapUpTab">
        <view class="{{selectedUpTab == item.value ? 'up-tab-item-active' : ''}}">{{item.name}}</view>
      </view>
    </view>
    
    <scroll-view class="down-tab" scroll-x="{{true}}" scroll-into-view="">
      <view class="flex-row flex-align-items" style="width: {{downTabs.length * 110}}rpx;">
        <view class="down-tab-item" wx:for="{{downTabs}}" wx:key="index" data-index="{{item.value}}" bind:tap="tapDownTab">
          <view class="{{(selectedUpTab == 'tem' && temTabIndex == item.value || selectedUpTab == 'face' && faceTabIndex == item.value) ? 'down-tab-item-active' : ''}}">{{item.name}}</view>
        </view>
      </view>
    </scroll-view>

    <scroll-view class="lists-box" scroll-y="{{true}}">
      <view class="lists flex-row flex-wrap">
        <view wx:for="{{list}}" wx:key="index" data-index="{{index}}" bind:tap="chooseItem">
          <image class="list-item-image" src="{{item.url}}" mode="aspectFit" lazy-load="{{true}}" />
        </view>
      </view>
      <view class="to-bottom">...到底啦...</view>
    </scroll-view>

    <view class="flex-row-center" style="padding: 30rpx 0;">
      <button wx:if="{{!authWritePhotosAlbum}}" class="button ch-button" bindtap="saveImage">保存</button>
      <button wx:else class="button ch-button" open-type="openSetting" bindopensetting="openSetting">保存</button>
      <button class="button" type="primary" bindtap="addText" style="background-color: #07c160;">加文字</button>
    </view>
  </view>

   <canvas class="canvas" canvas-id="drawer" style="width: {{temInfo.width}}px;height: {{temInfo.height}}px;"></canvas>
</view>
